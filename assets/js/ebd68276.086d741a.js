"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[557],{4820:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>h});var t=i(4848),s=i(8453);const a={output:"docusaurus-md",sidebar_position:2,description:"Second, read more on how to define the variant-disease model."},r="Specifying the penetrance {#specifying-the-penetrance}",o={id:"how-to/penetrance",title:"Specifying the penetrance",description:"Second, read more on how to define the variant-disease model.",source:"@site/docs/how-to/penetrance.md",sourceDirName:"how-to",slug:"/how-to/penetrance",permalink:"/shinyseg/how-to/penetrance",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{output:"docusaurus-md",sidebar_position:2,description:"Second, read more on how to define the variant-disease model."},sidebar:"tutorialSidebar",previous:{title:"The pedigree table",permalink:"/shinyseg/how-to/pedigree"},next:{title:"FLB and sensitivity",permalink:"/shinyseg/how-to/flb"}},l={},h=[{value:"Inheritance pattern",id:"inheritance-pattern",level:2},{value:"Penetrance mode",id:"penetrance-mode",level:2},{value:"1) Relative risk",id:"relative-risk",level:2},{value:"Sex-specific penetrances",id:"sex-specific-penetrances",level:3},{value:"Hazard ratios",id:"hazard-ratios",level:3},{value:"Optimal parameters",id:"optimal-parameters",level:3},{value:"Extra phenotypes",id:"extra-phenotypes",level:3},{value:"2) Liability class",id:"liability-class",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"specifying-the-penetrance",children:"Specifying the penetrance"}),"\n",(0,t.jsxs)(n.p,{children:["A critical aspect affecting the analysis output is the model connecting\ngenetic variant and disease. This is encoded by the penetrance function,\nwhich shinyseg allows to build with different degrees of complexity\nusing the ",(0,t.jsx)(n.em,{children:"Penetrance"})," panel."]}),"\n",(0,t.jsx)(n.h2,{id:"inheritance-pattern",children:"Inheritance pattern"}),"\n",(0,t.jsx)(n.p,{children:"The first decision regarding the penetrance relates to the inheritance\nmodel. Choose one of the options on the header:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AD"}),": autosomal dominant."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AR"}),": autosomal recessive."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AI"}),": autosomal incomplete dominance."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"XD"}),": X-linked dominant."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"XR"}),": X-linked recessive."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"XI"}),": X-linked incomplete dominance."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Note that incomplete dominance, where you can specify different\nparameters for the carriers of 1 and 2 copies of the variant, will be\nunavailable unless you also switch to the ",(0,t.jsx)(n.a,{href:"/how-to/penetrance#liability-class",children:"Liability\nclass"})," mode."]}),"\n",(0,t.jsx)(n.h2,{id:"penetrance-mode",children:"Penetrance mode"}),"\n",(0,t.jsx)(n.p,{children:"Next, it is time to assign the probabilities of observing the analysis\nphenotypes conditional on carriership status, hereafter referred to as\npenetrances. shinyseg offers two different ways to do it:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Relative risk"}),", where the penetrances are computed by the app\nbased on certain parameters."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Liability class"}),", where the user manually specifies them."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The mode can be switched anytime with the input on the left of the\nheader, but note that ",(0,t.jsx)(n.a,{href:"/how-to/penetrance#relative-risk",children:"Relative risk"}),"\nwill be unavailable if incomplete dominance is selected."]}),"\n",(0,t.jsx)(n.h2,{id:"relative-risk",children:"1) Relative risk"}),"\n",(0,t.jsxs)(n.p,{children:["This is a parametric version of the survival penetrances introduced by\n",(0,t.jsx)(n.a,{href:"https://doi.org/10.1038/s41436-020-0920-4",children:"Belman et al.\xa0(2020)"}),". It is\nbased on:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Baseline lifetime risk, mean and SD:"})," the lifetime risk, mean,\nand standard deviation of disease onset in non-carriers and\nheterozygous carriers in recessive inheritance."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hazard ratios:"})," the relative risks in homo-, hemi-, and\nheterozygous carriers in dominant inheritance, compared to the\nbaseline. They can be either constant or age-dependent and may also\nbe specified through a ",(0,t.jsx)(n.strong,{children:"variant-associated lifetime risk"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["These parameters are entered using a table generated from the phenotypes\nspecified in the pedigree table. For example, the following describes a\nconstant relative risk model in which non-carriers have a lifetime risk\nof ",(0,t.jsx)(n.code,{children:"affected"})," of 1% (phenocopy rate) with onset at 70\xb115 years of age,\nwhile heterozygous and homozygous carriers have a lifetime risk of 75%."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"                   neg             het/hom                    \n  sex  phenotype  risk  mean  SD      risk     hazard ratio(s)\n both   affected  0.01    70  15      0.75              137.93\n"})}),"\n",(0,t.jsx)(n.p,{children:"Below the table, you will also find a plot which can serve as a visual\naid displaying the cumulative incidences, hazard rates, or hazard ratios\ndetermined by the current selection."}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"None of the model parameters can be missing."})}),"\n",(0,t.jsx)(n.h3,{id:"sex-specific-penetrances",children:"Sex-specific penetrances"}),"\n",(0,t.jsxs)(n.p,{children:["By default, shinyseg generates a unique entry for each phenotype. This\nmeans that the specified penetrances will apply to ",(0,t.jsx)(n.code,{children:"both"})," sexes.\nHowever, you can click on this field and select ",(0,t.jsx)(n.code,{children:"male"})," or ",(0,t.jsx)(n.code,{children:"female"})," to\ncreate a sex-depended specification. For instance:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"                     neg             het/hom                    \n    sex  phenotype  risk  mean  SD      risk     hazard ratio(s)\n   male   affected  0.01    70  15      0.75              137.94\n female   affected  0.25    80  15      0.90                8.00\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To undo it, change back to ",(0,t.jsx)(n.code,{children:"both"})," any of two the sex-specific entries."]}),"\n",(0,t.jsx)(n.h3,{id:"hazard-ratios",children:"Hazard ratios"}),"\n",(0,t.jsxs)(n.p,{children:["The previous examples ignored the ",(0,t.jsx)(n.strong,{children:"hazard ratio(s)"})," column, which\ncontained the constant (age-independent) relative risk of ",(0,t.jsx)(n.code,{children:"affected"})," in\nvariant carriers compared to the baseline. This is because shinyseg\nallows to input the ",(0,t.jsx)(n.strong,{children:"variant-associated lifetime risk"})," instead, and\nupdates the other column accordingly. However, users can also manipulate\nthe hazard ratios directly, in which case it will be the other input\nthat be updated."]}),"\n",(0,t.jsxs)(n.p,{children:["Although more complicated, the direct specification of the ",(0,t.jsx)(n.strong,{children:"hazard\nratio(s)"})," has the advantage of allowing for age-dependent relative\nrisks if, instead of a single value, a vector is provided. Specifically,\nit admits up to 10 comma-separated values representing, loosely\nspeaking, the hazard ratios at evenly spaced ages from 1 to 100 years.\nFor instance, ",(0,t.jsx)(n.code,{children:"1,10,10,20,10"})," would roughly correspond to the values at\nages 1, 25, 50, 75 and 100. The app will interpolate/smooth these across\nthe lifespan using a B-spline basis \u2014 you may adjust the smoothing\ndegree with the ",(0,t.jsx)(n.strong,{children:"Splines"})," input at the bottom. ",(0,t.jsx)(n.a,{href:"/example3/",children:"Example #3: Multiple\nphenotypes"})," showcases a penetrance model with age-dependent\nrelative risks."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"If you misspecify the hazard ratio(s), their values will revert to the\nprevious ones to prevent issues."})}),"\n",(0,t.jsxs)(n.p,{children:["Note that it is also possible to leverage the ",(0,t.jsx)(n.strong,{children:"variant-associated\nlifetime risk"}),", as earlier, but combined with a vectorial specification\nof the hazard ratios. For instance, changing the ",(0,t.jsx)(n.strong,{children:"hazard ratio(s)"})," to\n",(0,t.jsx)(n.code,{children:"1,2,2,1"})," defines a model where the relative risk is higher at middle\nages. Subsequently, resetting the lifetime risk to 75% will scale these\nvalues accordingly, resulting in:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"                   neg             het/hom                         \n  sex  phenotype  risk  mean  SD      risk          hazard ratio(s)\n both   affected  0.01    70  15      0.75     1, 305.02, 305.02, 1\n"})}),"\n",(0,t.jsx)(n.h3,{id:"optimal-parameters",children:"Optimal parameters"}),"\n",(0,t.jsxs)(n.p,{children:["As choosing the model parameters can be challenging, shinyseg also\noffers an ",(0,t.jsx)(n.strong,{children:"Assistant"})," to optimize them based on user-provided\ncumulative incidence data."]}),"\n",(0,t.jsxs)(n.p,{children:["To use it, simply specify pairs of age (integer between 1-100) and their\ncorresponding cumulative incidence in the table provided. The ",(0,t.jsx)(n.strong,{children:"Length"}),"\nslider also allows to fine tune the model\u2019s complexity by defining the\nnumber of values for the hazard ratio vector. The app will then find the\noptimal parameters, which you may easily transfer them to your analysis\nwith ",(0,t.jsx)(n.strong,{children:"Use these parameters for\u2026"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"extra-phenotypes",children:"Extra phenotypes"}),"\n",(0,t.jsxs)(n.p,{children:["Sometimes, as in ",(0,t.jsx)(n.a,{href:"/example3/",children:"Example #3: Multiple phenotypes"}),", not all\nphenotypes relevant for the penetrance function may be observed in the\nanalysis families. This means that, by default, they will not appear in\nthe table where you can set their parameters. Type their names in the\n",(0,t.jsx)(n.strong,{children:"Extra phenotypes"})," input, at the bottom, to remedy it."]}),"\n",(0,t.jsx)(n.h2,{id:"liability-class",children:"2) Liability class"}),"\n",(0,t.jsx)(n.p,{children:"Alternatively, users can manually define penetrances using a table. This\ntable contains 2 (dominant/recessive) to 3 (incomplete inheritance)\ncolumns with the penetrances themselves, followed by an additional 3\ncolumns specifying the classes they apply to:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"sex:"})," ",(0,t.jsx)(n.code,{children:"male"}),", ",(0,t.jsx)(n.code,{children:"female"}),", or ",(0,t.jsx)(n.code,{children:"both"})," for classes referring to males,\nfemales, or both sexes, respectively; leaving this cell empty is\nequivalent to specifying ",(0,t.jsx)(n.code,{children:"both"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"phenotype:"})," a free-text field whose values should match the\nphenotypes in the pedigree table. Note that here, ",(0,t.jsx)(n.code,{children:"nonaff"})," is\ntreated as another phenotype whose classes must be specified (unless\nthere are no unaffected cases); leaving this cell empty indicates\nthat the class applies to all phenotypes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ages:"})," an integer from 1 to 100 or ranges between these values\n(e.g., 10-20, 30-100\u2026) indicating the ages to which the class\napplies; leaving this cell empty is equivalent to specifying ages\n1-100."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For instance, the following illustrates an autosomal dominant model with\nno phenocopies, where both heterozygous and homozygous carriers have a\n100% chance of disease onset:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"  neg   het/hom                       \n risk      risk   sex  phenotype  ages\n 0.00      1.00                       \n"})}),"\n",(0,t.jsx)(n.p,{children:"And the following defines a sex- and age-dependent specification with\nincomplete dominance:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"  neg   het   hom                             \n risk  risk  risk      sex   phenotype    ages\n 0.00  0.20  0.40     male                1-50\n 0.00  0.20  0.40   female                1-50\n 0.05  0.40  0.70     male              51-100\n 0.20  0.40  0.90   female              51-100\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The table may be created interactively or by uploading a file via ",(0,t.jsx)(n.strong,{children:"Load\nfile"}),". If opting for the latter, shinyseg expects a tabular file\nwithout column headers and a structure resembling the one shown in-app."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"There should be no sex/phenotype/age overlaps. All family members should\nmap to a single liability class without missing penetrances."})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var t=i(6540);const s={},a=t.createContext(s);function r(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);