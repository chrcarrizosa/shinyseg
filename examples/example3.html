<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-examples/example3" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">3) Two phenotypes | shinyseg</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://chrcarrizosa.github.io/shinyseg/examples/example3"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3) Two phenotypes | shinyseg"><meta data-rh="true" name="description" content="An example with two phenotypes in a consanguineous family."><meta data-rh="true" property="og:description" content="An example with two phenotypes in a consanguineous family."><link data-rh="true" rel="canonical" href="https://chrcarrizosa.github.io/shinyseg/examples/example3"><link data-rh="true" rel="alternate" href="https://chrcarrizosa.github.io/shinyseg/examples/example3" hreflang="en"><link data-rh="true" rel="alternate" href="https://chrcarrizosa.github.io/shinyseg/examples/example3" hreflang="x-default"><link rel="stylesheet" href="/shinyseg/assets/css/styles.06b1c5fa.css">
<script src="/shinyseg/assets/js/runtime~main.add38475.js" defer="defer"></script>
<script src="/shinyseg/assets/js/main.f489c32d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/shinyseg/"><b class="navbar__title text--truncate">shinyseg</b></a><div class="navbar__item">A web application for clinical cosegregation analysis</div></div><div class="navbar__items navbar__items--right"><a href="https://chrcarrizosa.shinyapps.io/shinyseg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link button button--secondary button">To the app</a><a href="https://github.com/chrcarrizosa/shinyseg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub"></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/shinyseg/"><b>shinyseg</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/shinyseg/">Welcome to shinyseg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/shinyseg/quick-start">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/shinyseg/how-to">How to…</a><button aria-label="Collapse sidebar category &#x27;How to…&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/how-to/pedigree">The pedigree table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/how-to/penetrance">Specifying the penetrance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/how-to/flb">FLB and sensitivity</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/shinyseg/examples">Examples</a><button aria-label="Collapse sidebar category &#x27;Examples&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/examples/example1">1) Constant relative risk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/examples/example2">2) X-linked inheritance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/shinyseg/examples/example3">3) Two phenotypes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/examples/example4">4) Breast cancer and BRCA1</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/shinyseg/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/shinyseg/examples"><span itemprop="name">Examples</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3) Two phenotypes</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>3) Two phenotypes</h1>
<p>This example demonstrates how to incorporate multiple phenotypes into
the cosegregation analysis. It also showcases how the app can deal with
consanguineous families.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pedigree-table">Pedigree table<a href="#pedigree-table" class="hash-link" aria-label="Direct link to Pedigree table" title="Direct link to Pedigree table">​</a></h2>
<p>The data corresponding to the case is shown below:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ped id fid mid sex phenotype carrier proband age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  1   0   0   1         .       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  2   0   0   2         .       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  3   1   2   1         .       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  4   0   0   2      mild       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  5   1   2   1         .       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  6   0   0   2    nonaff       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  7   3   4   1    severe     het       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  8   0   0   2    nonaff       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  9   5   6   1      mild       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 10   0   0   2    nonaff       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 11   7   8   1    nonaff       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 12   9  10   2      mild     het       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 13  11  12   1    severe     het       1  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 14  11  12   2      mild     het       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 15  11  12   2    nonaff     neg       .  50</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="/shinyseg/assets/images/ex3-ped-0061b0ac6f8cdcf649fd29275d6b6470.png" style="max-height:350px">
<p>In this family, there are two disease phenotypes: one relatively mild
and common, and one more rare and severe. It is hypothesized that the
rare autosomal variant found in some members (indicated by + or –) could
be associated with increased risks for both.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="simplified-models">Simplified models<a href="#simplified-models" class="hash-link" aria-label="Direct link to Simplified models" title="Direct link to Simplified models">​</a></h2>
<p>In a first approach, we will ignore onset/censoring ages by switching to
the <code>Liability class</code> mode and declaring age-independent classes.</p>
<p>The most basic strategy would be to also disregard the distinction
between both phenotypes and treat both as the same “affected”. For
instance, let’s assume that we suspect the phenocopy rate and penetrance
for the mild phenotype to be 20% and 70%, respectively, and we decide to
apply these values to all pedigree members:</p>
<img src="/shinyseg/assets/images/ex3-lclass1-tab-eca12be8ea017e7d213d0bd685414fdb.png" style="max-height:185px">
<p>With this setup, we would obtain moderate evidence for pathogenicity, as
shown below. The sensitivity analysis also indicates that increasing the
ratio of the penetrance-to-phenocopy rate would increase the evidence.</p>
<img src="/shinyseg/assets/images/ex3-lclass1-flb-2b757ea09ae239fbfdd9053e8d33aef3.png" style="max-height:550px">
<p>However, we should account for the differences between both phenotypes,
if they exist. Luckily, this can be easily done by adding more liability
classes and specifying the cases to which they apply. For instance, in
the following, we set a phenocopy rate and penetrance for the severe
phenotype of 1% and 25%, respectively. Notice that now we also need to
specify the parameters for the “nonaffected” phenotype (<code>nonaff</code>), which
refer to the risk for <em>any</em> of the disease phenotypes.</p>
<img src="/shinyseg/assets/images/ex3-lclass2-tab-c6f2e58a79cb74ed4cde90d192ffdf59.png" style="max-height:225px">
<p>And with that, the FLB shoots to 45.3, resulting in strong evidence for
pathogenicity.</p>
<img src="/shinyseg/assets/images/ex3-lclass2-flb-92b8bc4f7af283fbe76c165df510fe5b.png" style="max-height:150px">
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="accounting-for-ages">Accounting for ages<a href="#accounting-for-ages" class="hash-link" aria-label="Direct link to Accounting for ages" title="Direct link to Accounting for ages">​</a></h2>
<p>Now, let’s complicate the model by considering the ages (of onset or
censoring) shown below each pedigree member. This can be done by
declaring age-specific liability classes, but it can quickly get
cumbersome. To do it, we will switch back to the <code>Relative risk</code> mode.</p>
<p>In this mode, we cannot overlook the distinction between both
phenotypes; we must specify the parameters for both. In the following,
we use the same risk values (now referring to lifetime risks) as before.
Additionally, we consider that phenocopies have an expected onset at
75±20 years of age for the mild phenotype and 60±15 years for the severe
one. Notice that for the former, we also specify that the risk conferred
by the variant is higher at middle ages; you can find further details on
how to do this <a href="/shinyseg/how-to/penetrance#hazard-ratios">here</a>.</p>
<img src="/shinyseg/assets/images/ex3-rrisk-tab-00c3df49266aad95a6fc4bd23fff7f8e.png" style="max-height:500px">
<p>After accounting for the age data, cosegregation evidence is reduced
considerably, although it remains strong (FLB &gt; 32).</p>
<img src="/shinyseg/assets/images/ex3-rrisk-flb-66a2915e989a0dba1a3bc6fc8b243728.png" style="max-height:150px"></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/shinyseg/examples/example2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">2) X-linked inheritance</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/shinyseg/examples/example4"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">4) Breast cancer and BRCA1</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pedigree-table" class="table-of-contents__link toc-highlight">Pedigree table</a></li><li><a href="#simplified-models" class="table-of-contents__link toc-highlight">Simplified models</a></li><li><a href="#accounting-for-ages" class="table-of-contents__link toc-highlight">Accounting for ages</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Site built with Docusaurus.</div></div></div></footer></div>
</body>
</html>