<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-examples/example1" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">1) Constant relative risk | shinyseg</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://chrcarrizosa.github.io/shinyseg/examples/example1"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="1) Constant relative risk | shinyseg"><meta data-rh="true" name="description" content="A simple case to showcase the relative risk mode and the importance of accounting for age of onset."><meta data-rh="true" property="og:description" content="A simple case to showcase the relative risk mode and the importance of accounting for age of onset."><link data-rh="true" rel="canonical" href="https://chrcarrizosa.github.io/shinyseg/examples/example1"><link data-rh="true" rel="alternate" href="https://chrcarrizosa.github.io/shinyseg/examples/example1" hreflang="en"><link data-rh="true" rel="alternate" href="https://chrcarrizosa.github.io/shinyseg/examples/example1" hreflang="x-default"><link rel="stylesheet" href="/shinyseg/assets/css/styles.f1035914.css">
<script src="/shinyseg/assets/js/runtime~main.d31c44e6.js" defer="defer"></script>
<script src="/shinyseg/assets/js/main.027527af.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/shinyseg/"><b class="navbar__title text--truncate">shinyseg</b></a><div class="navbar__item">A web application for clinical cosegregation analysis</div></div><div class="navbar__items navbar__items--right"><a href="https://chrcarrizosa.shinyapps.io/shinyseg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link button button--secondary button">To the app</a><a href="https://github.com/chrcarrizosa/shinyseg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar--github-link" aria-label="GitHub"></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/shinyseg/"><b>shinyseg</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/shinyseg/">Welcome to shinyseg</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/shinyseg/quick-start">Quick start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/shinyseg/how-to">How to…</a><button aria-label="Collapse sidebar category &#x27;How to…&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/how-to/pedigree">The pedigree table</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/how-to/penetrance">Specifying the penetrance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/how-to/flb">FLB and sensitivity</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/shinyseg/examples">Examples</a><button aria-label="Collapse sidebar category &#x27;Examples&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/shinyseg/examples/example1">1) Constant relative risk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/examples/example2">2) X-linked inheritance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shinyseg/examples/example3">3) Breast cancer and BRCA1</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/shinyseg/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/shinyseg/examples"><span itemprop="name">Examples</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">1) Constant relative risk</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>1) Constant relative risk</h1>
<p>This example pertains to a family suffering from a rare connective
tissue disorder in which a rare autosomal variant was identified. The
case primarily focuses on accounting for unaffected carriers who are
relatively young compared to the expected onset of the disease.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pedigree-table">Pedigree table<a href="#pedigree-table" class="hash-link" aria-label="Direct link to Pedigree table" title="Direct link to Pedigree table">​</a></h2>
<p>The data corresponding to the case is shown below:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ped id fid mid sex phenotype carrier proband age</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  1   0   0   1         .       .       .  80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  2   0   0   2         .       .       .  80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  3   1   2   1    nonaff       .       .  40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  4   0   0   2    nonaff       .       .  80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  5   1   2   1  affected     het       .  60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  6   0   0   2    nonaff       .       .  80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  7   3   4   1    nonaff     neg       .  60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  8   3   4   1  affected     het       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1  9   0   0   2    nonaff       .       .  60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 10   5   6   1  affected     het       .  30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 11   0   0   2    nonaff       .       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 12   5   6   1    nonaff     neg       .  50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 13   8   9   2  affected     het       1  30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 14   8   9   2    nonaff     neg       .  30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 15   8   9   1    nonaff     het       .  30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1 16  10  11   1    nonaff     het       .  30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<img src="/shinyseg/assets/images/ex1-ped-2ed31045b32515bc1112192d6627dd2d.png" style="max-height:350px">
<p>In brief, there are four affected family members with disease onset
occurring between the ages of 30 and 60 years, all of whom are carriers.
Additionally, five unaffected individuals have been tested, revealing
that two individuals from the youngest generation (aged 30 years) are
carriers. Moreover, the proband’s grandfather is likely an obligate
carrier, although he remained asymptomatic until his death in his 40s.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="a-single-liability-class">A single liability class<a href="#a-single-liability-class" class="hash-link" aria-label="Direct link to A single liability class" title="Direct link to A single liability class">​</a></h2>
<p>The simplest way to analyze these data is to consider a single risk
parameter for noncarriers (phenocopy rate) and another for carriers
(penetrance). This can be achieved by switching the mode to
<code>Liability class</code> and then setting a single liability class, which will
apply to all cases regardless of phenotype, sex, and age. For example,
the following will set a phenocopy rate of 0.001 and a penetrance of
0.90, which may be viewed as somewhat conservative values.</p>
<img src="/shinyseg/assets/images/ex1-lclass1-tab-5ea9b16bab115fc28427fd27621b0fec.png" style="max-height:150px">
<p>After completing these steps, the <em>FLB</em> panel becomes available. Upon
clicking on <strong>Calculate</strong>, a value of 3.2 is generated, indicating
inconclusive evidence regarding the variant’s pathogenicity (FLB &lt; 8).</p>
<img src="/shinyseg/assets/images/ex1-lclass1-flb-3c24f29d3901ebf041c21972fbf96690.png" style="max-height:150px">
<p>Now, let’s conduct a sensitivity analysis to assess the robustness of
this result. Click on <strong>Sensitivity</strong> and select <code>het/hom risk</code>
(penetrance) as the first parameter and <code>neg risk</code> (phenocopy rate) as
the second. Adjust the ranges of values to test to <code>0.5–0.9999</code> and
<code>0.0001–0.10</code>, respectively, and then click on <strong>Plot</strong>.</p>
<img src="/shinyseg/assets/images/ex1-lclass1-sen-ffe8b741ee4b8f94766db1c3b4e199c8.png" style="max-height:350px">
<p>We can observe that reducing the carriers’ risk enhances the evidence,
primarily due to the presence of unaffected carriers. However, it’s
important to note that in this case, these carriers are also young.
Accounting for this fact may significantly increase the FLB value.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="more-liability-classes">More liability classes<a href="#more-liability-classes" class="hash-link" aria-label="Direct link to More liability classes" title="Direct link to More liability classes">​</a></h2>
<p>The easiest method to achieve this is by adding more liability classes.
This can be accomplished effortlessly by clicking on <strong>ADD</strong> and
completing the new rows in the liability class table. For instance, the
following configuration specifies that the penetrance in individuals
aged 1-40 will be 0.45, which is half the value for the older
individuals.</p>
<img src="/shinyseg/assets/images/ex1-lclass2-tab-308ecc1fa7fd26b1b74a8dd170ee4889.png" style="max-height:175px">
<p>With this simple adjustment, the FLB jumps to 34.3, indicating strong
evidence for pathogenicity (FLB &gt; 32). However, conducting a
sensitivity analysis by comparing the penetrances in the young
(<code>1-40 | het/hom risk</code>) and old (<code>41-100 | het/hom risk</code>) age groups
reveals that this result is not robust.</p>
<img src="/shinyseg/assets/images/ex1-lclass2-sen-ceda231ef2be9bb45d7c5e492e44d7c1.png" style="max-height:500px">
<p>It’s possible that different conclusions may arise if we implement a
more detailed age group classification. However, doing so makes
sensitivity analyses increasingly cumbersome, as each new liability
class introduces two additional parameters.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="relative-risk-mode">Relative risk mode<a href="#relative-risk-mode" class="hash-link" aria-label="Direct link to Relative risk mode" title="Direct link to Relative risk mode">​</a></h2>
<p>Alternatively, we can revert to the default <code>Relative risk</code> mode. This
mode simplifies the specification of age-specific penetrances while
ensuring that modeling assumptions remain transparent and manageable
within a reasonable number of parameters.</p>
<p>For instance, in the following model, we define lifetime risks of 0.001
for non-carriers (<code>neg risk</code>) and 0.90 for carriers (<code>het/hom risk</code>).
Additionally, we specify that phenocopies have an age of onset around
60±15 years of age (<code>neg mean</code> and <code>neg SD</code>). The last parameter,
<code>hazard ratio(s)</code>, is automatically updated by the app. Since it
contains a single value, it implies that we are assuming a constant
relative risk model. The plots below illustrate how these inputs
translate to the expected cumulative incidences in carriers (solid
lines) and non-carriers (dashed lines) of the variant.</p>
<img src="/shinyseg/assets/images/ex1-rrisk-tab-29568c907c4b1b19f6949d4a1adbf18a.png" style="max-height:400px">
<p>With the updated parameters, we now obtain an FLB score of 30.3,
indicating evidence for pathogenicity (FLB &gt; 16). Conducting a
sensitivity analysis comparing both lifetime risks demonstrates that
this conclusion is robust.</p>
<img src="/shinyseg/assets/images/ex1-rrisk-sen-c8979969e13e65fc5e08ea805dbab36d.png" style="max-height:500px"></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/shinyseg/examples"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Examples</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/shinyseg/examples/example2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">2) X-linked inheritance</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pedigree-table" class="table-of-contents__link toc-highlight">Pedigree table</a></li><li><a href="#a-single-liability-class" class="table-of-contents__link toc-highlight">A single liability class</a></li><li><a href="#more-liability-classes" class="table-of-contents__link toc-highlight">More liability classes</a></li><li><a href="#relative-risk-mode" class="table-of-contents__link toc-highlight">Relative risk mode</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Site built with Docusaurus.</div></div></div></footer></div>
</body>
</html>